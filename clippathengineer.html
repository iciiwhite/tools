<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clip Path Engineer | Professional Vector Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --accent: #3b82f6;
            --accent-glow: rgba(59, 130, 246, 0.5);
        }

        body {
            background-color: #09090b;
            color: #f4f4f5;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            overflow: hidden;
        }

        .workspace-grid {
            background-image: 
                linear-gradient(to right, #18181b 1px, transparent 1px),
                linear-gradient(to bottom, #18181b 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .node {
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease, box-shadow 0.2s ease, background-color 0.2s;
            cursor: grab;
        }

        .node:active { cursor: grabbing; }

        .node.active {
            background: white;
            box-shadow: 0 0 0 4px var(--accent-glow);
            z-index: 100;
        }

        .sidebar-transition {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .custom-scrollbar::-webkit-scrollbar { width: 5px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #27272a; border-radius: 10px; }

        input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; }

        #canvas-container {
            touch-action: none;
            user-select: none;
        }

        .glass-panel {
            background: rgba(18, 18, 21, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(39, 39, 42, 0.5);
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Header -->
    <header class="h-14 border-b border-zinc-800 bg-zinc-900/50 backdrop-blur-md flex items-center justify-between px-4 z-50">
        <div class="flex items-center gap-4">
            <button id="toggle-sidebar" class="p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 transition-colors">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M9 3v18"/></svg>
            </button>
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-lg shadow-blue-900/20">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3"><path d="M21 3L3 21M21 3H12M21 3V12M3 21H12M3 21V12"/></svg>
                </div>
                <div>
                    <h1 class="font-bold text-sm tracking-tight leading-none">ClipPath<span class="text-blue-500">Engineer</span></h1>
                    <p class="text-[9px] text-zinc-500 uppercase tracking-widest font-medium mt-1">Vector Precision v2.0</p>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <div class="flex bg-zinc-800/50 p-1 rounded-lg border border-zinc-700/50">
                <button class="tab-btn px-4 py-1 text-[11px] font-bold rounded-md bg-blue-600 text-white shadow-sm" data-tab="css">CSS</button>
                <button class="tab-btn px-4 py-1 text-[11px] font-bold rounded-md text-zinc-400 hover:text-white transition-colors" data-tab="svg">SVG</button>
            </div>
            <button id="copy-btn" class="flex items-center gap-2 bg-zinc-100 hover:bg-white text-black px-4 py-1.5 rounded-lg text-[11px] font-bold transition-all active:scale-95">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                <span>Copy Code</span>
            </button>
        </div>
    </header>

    <div class="flex-1 flex overflow-hidden relative">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar-transition w-72 border-r border-zinc-800 bg-[#0c0c0e] flex flex-col z-40">
            <div class="p-4 space-y-8 overflow-y-auto custom-scrollbar flex-1">
                <section>
                    <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-[0.2em] mb-4 block">Basic Polygons</label>
                    <div id="presets-geometric" class="grid grid-cols-1 gap-2"></div>
                </section>
                <section>
                    <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-[0.2em] mb-4 block">UI Component Shapes</label>
                    <div id="presets-ui" class="grid grid-cols-1 gap-2"></div>
                </section>
                <section>
                    <label class="text-[10px] font-bold text-zinc-500 uppercase tracking-[0.2em] mb-4 block">Complex Creative</label>
                    <div id="presets-creative" class="grid grid-cols-1 gap-2"></div>
                </section>
            </div>
        </aside>

        <!-- Main Workspace -->
        <main class="flex-1 flex flex-col bg-[#050506] relative">
            <div class="flex-1 flex items-center justify-center p-8 lg:p-16 relative">
                <div class="absolute inset-0 workspace-grid opacity-20"></div>
                
                <div id="canvas-container" class="relative w-full max-w-xl aspect-square bg-zinc-900/30 border border-zinc-800/50 rounded-2xl shadow-2xl cursor-crosshair">
                    <!-- Image Preview -->
                    <div id="clip-preview" class="absolute inset-0 rounded-2xl overflow-hidden transition-all duration-300">
                        <img src="https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?auto=format&fit=crop&q=80&w=1200" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-tr from-blue-600/20 to-transparent mix-blend-overlay"></div>
                    </div>

                    <!-- SVG Layer -->
                    <svg id="svg-layer" class="absolute inset-0 w-full h-full pointer-events-none overflow-visible">
                        <polygon id="vector-path" points="" fill="rgba(59, 130, 246, 0.15)" stroke="#3b82f6" stroke-width="2.5" stroke-linejoin="round" />
                    </svg>

                    <!-- Handle Container -->
                    <div id="handles-container" class="absolute inset-0 pointer-events-none"></div>

                    <!-- Tooltip -->
                    <div id="coord-tip" class="absolute pointer-events-none bg-blue-600 text-white text-[10px] font-black px-1.5 py-0.5 rounded shadow-lg opacity-0 transition-opacity z-50"></div>
                </div>

                <!-- Canvas Instructions -->
                <div class="absolute bottom-6 left-1/2 -translate-x-1/2 bg-zinc-900/80 border border-zinc-800 px-4 py-2 rounded-full flex items-center gap-4 text-[10px] text-zinc-400 font-medium backdrop-blur-sm">
                    <span class="flex items-center gap-1.5"><kbd class="bg-zinc-800 px-1.5 py-0.5 rounded border border-zinc-700 text-zinc-200">Drag</kbd> Move node</span>
                    <span class="flex items-center gap-1.5"><kbd class="bg-zinc-800 px-1.5 py-0.5 rounded border border-zinc-700 text-zinc-200">Dbl Click</kbd> Add node</span>
                </div>
            </div>

            <!-- Inspector Panel -->
            <div class="h-64 border-t border-zinc-800 bg-[#0c0c0e] flex overflow-hidden">
                <!-- Code Panel -->
                <div class="flex-1 flex flex-col min-w-0 border-r border-zinc-800">
                    <div class="flex items-center px-4 h-9 border-b border-zinc-800 bg-zinc-900/30">
                        <span class="text-[9px] font-black text-zinc-500 uppercase tracking-widest">Source Code</span>
                    </div>
                    <div class="flex-1 p-4 overflow-auto font-mono text-[12px] leading-relaxed custom-scrollbar bg-black/40">
                        <pre id="code-output" class="text-zinc-400"></pre>
                    </div>
                </div>

                <!-- Nodes Panel -->
                <div class="w-80 flex flex-col shrink-0 bg-zinc-900/10">
                    <div class="flex items-center justify-between px-4 h-9 border-b border-zinc-800 bg-zinc-900/30">
                        <span class="text-[9px] font-black text-zinc-500 uppercase tracking-widest">Node Inspector</span>
                        <span id="point-count" class="text-[9px] font-bold text-blue-500 bg-blue-500/10 px-2 py-0.5 rounded-full">0 nodes</span>
                    </div>
                    <div id="inspector-list" class="flex-1 overflow-y-auto p-3 space-y-1.5 custom-scrollbar"></div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- Configuration & Data ---
        let points = [[50, 5], [95, 95], [5, 95]];
        let draggingIdx = null;
        let activeTab = 'css';
        let sidebarOpen = true;

        const presets = {
            geometric: [
                { name: 'Triangle', pts: [[50,0], [100,100], [0,100]] },
                { name: 'Rectangle', pts: [[0,0], [100,0], [100,100], [0,100]] },
                { name: 'Trapezoid', pts: [[20,0], [80,0], [100,100], [0,100]] },
                { name: 'Pentagon', pts: [[50,0], [100,38], [82,100], [18,100], [0,38]] },
                { name: 'Hexagon', pts: [[25,0], [75,0], [100,50], [75,100], [25,100], [0,50]] },
                { name: 'Octagon', pts: [[30,0], [70,0], [100,30], [100,70], [70,100], [30,100], [0,70], [0,30]] }
            ],
            ui: [
                { name: 'Message Box', pts: [[0,0], [100,0], [100,75], [25,75], [0,100], [0,75]] },
                { name: 'Chevron Right', pts: [[0,0], [75,0], [100,50], [75,100], [0,100], [25,50]] },
                { name: 'Tag Label', pts: [[20,0], [100,0], [100,100], [20,100], [0,50]] },
                { name: 'Ticket Edge', pts: [[0,0], [100,0], [100,35], [90,50], [100,65], [100,100], [0,100], [0,65], [10,50], [0,35]] }
            ],
            creative: [
                { name: 'Star', pts: [[50,0], [61,35], [98,35], [68,57], [79,91], [50,70], [21,91], [32,57], [2,35], [39,35]] },
                { name: 'Cross', pts: [[35,0], [65,0], [65,35], [100,35], [100,65], [65,65], [65,100], [35,100], [35,65], [0,65], [0,35], [35,35]] },
                { name: 'Close Icon', pts: [[0,15], [15,0], [50,35], [85,0], [100,15], [65,50], [100,85], [85,100], [50,65], [15,100], [0,85], [35,50]] }
            ]
        };

        // --- DOM Elements ---
        const canvas = document.getElementById('canvas-container');
        const handlesContainer = document.getElementById('handles-container');
        const vectorPath = document.getElementById('vector-path');
        const clipPreview = document.getElementById('clip-preview');
        const codeOutput = document.getElementById('code-output');
        const inspectorList = document.getElementById('inspector-list');
        const pointCountEl = document.getElementById('point-count');
        const coordTip = document.getElementById('coord-tip');
        const sidebar = document.getElementById('sidebar');

        // --- Logic ---
        function updatePointsUI() {
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;

            // 1. Update Preview & SVG
            const polyString = `polygon(${points.map(p => `${p[0]}% ${p[1]}%`).join(', ')})`;
            clipPreview.style.clipPath = polyString;
            
            const svgPoints = points.map(p => `${(p[0]/100) * width},${(p[1]/100) * height}`).join(' ');
            vectorPath.setAttribute('points', svgPoints);

            // 2. Update Inspector List
            pointCountEl.innerText = `${points.length} nodes`;
            inspectorList.innerHTML = '';
            points.forEach((p, i) => {
                const item = document.createElement('div');
                item.className = 'flex items-center gap-2 group p-1.5 rounded-lg hover:bg-zinc-800/30 transition-all';
                item.innerHTML = `
                    <div class="w-5 h-5 flex items-center justify-center bg-zinc-800 rounded text-[9px] font-bold text-zinc-500">${i+1}</div>
                    <div class="flex-1 flex gap-1.5">
                        <div class="flex-1 flex items-center bg-black/40 border border-zinc-800 rounded px-2 py-0.5">
                            <span class="text-[8px] font-bold text-zinc-600 mr-2">X</span>
                            <input type="number" step="1" value="${p[0]}" oninput="editPoint(${i}, 0, this.value)" class="w-full bg-transparent text-[11px] font-mono text-blue-400 focus:outline-none">
                        </div>
                        <div class="flex-1 flex items-center bg-black/40 border border-zinc-800 rounded px-2 py-0.5">
                            <span class="text-[8px] font-bold text-zinc-600 mr-2">Y</span>
                            <input type="number" step="1" value="${p[1]}" oninput="editPoint(${i}, 1, this.value)" class="w-full bg-transparent text-[11px] font-mono text-blue-400 focus:outline-none">
                        </div>
                    </div>
                    <button onclick="removePoint(${i})" class="opacity-0 group-hover:opacity-100 text-zinc-600 hover:text-red-400 transition-all">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
                    </button>
                `;
                inspectorList.appendChild(item);
            });

            // 3. Update Handles
            handlesContainer.innerHTML = '';
            points.forEach((p, i) => {
                const handle = document.createElement('div');
                handle.className = `node absolute w-3.5 h-3.5 rounded-full border-2 border-blue-500 bg-zinc-950 pointer-events-auto ${draggingIdx === i ? 'active scale-125' : 'hover:scale-110'}`;
                handle.style.left = `${p[0]}%`;
                handle.style.top = `${p[1]}%`;
                
                handle.addEventListener('mousedown', (e) => {
                    e.stopPropagation();
                    draggingIdx = i;
                    updatePointsUI();
                });
                
                handlesContainer.appendChild(handle);
            });

            // 4. Update Code
            renderCode();
        }

        function renderCode() {
            if (activeTab === 'css') {
                codeOutput.innerHTML = `<span class="text-zinc-500">.element</span> {
  <span class="text-indigo-400">clip-path</span>: <span class="text-blue-400">polygon</span>(
    ${points.map(p => `<span class="text-emerald-400">${p[0]}%</span> <span class="text-emerald-400">${p[1]}%</span>`).join(',\n    ')}
  );
}`;
            } else {
                codeOutput.innerHTML = `<span class="text-zinc-600">&lt;!-- Use 0-100 viewBox --&gt;</span>
<span class="text-zinc-500">&lt;svg viewBox="0 0 100 100"&gt;</span>
  <span class="text-zinc-500">&lt;polygon</span> <span class="text-indigo-400">points</span>="<span class="text-blue-400">${points.map(p => `${p[0]} ${p[1]}`).join(', ')}</span>" <span class="text-zinc-500">/&gt;</span>
<span class="text-zinc-500">&lt;/svg&gt;</span>`;
            }
        }

        window.editPoint = (idx, axis, val) => {
            let v = parseInt(val) || 0;
            points[idx][axis] = Math.max(0, Math.min(100, v));
            updatePointsUI();
        };

        window.removePoint = (idx) => {
            if (points.length <= 3) return;
            points.splice(idx, 1);
            updatePointsUI();
        };

        // --- Events ---
        canvas.addEventListener('dblclick', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = Math.round(((e.clientX - rect.left) / rect.width) * 100);
            const y = Math.round(((e.clientY - rect.top) / rect.height) * 100);
            points.push([x, y]);
            updatePointsUI();
        });

        window.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = Math.round(((e.clientX - rect.left) / rect.width) * 100);
            const y = Math.round(((e.clientY - rect.top) / rect.height) * 100);

            // Tooltip logic
            if (x >= -5 && x <= 105 && y >= -5 && y <= 105) {
                coordTip.style.opacity = '1';
                coordTip.style.left = `${e.clientX - rect.left + 15}px`;
                coordTip.style.top = `${e.clientY - rect.top - 25}px`;
                coordTip.innerText = `${Math.max(0, Math.min(100, x))}, ${Math.max(0, Math.min(100, y))}`;
            } else {
                coordTip.style.opacity = '0';
            }

            if (draggingIdx === null) return;
            points[draggingIdx][0] = Math.max(0, Math.min(100, x));
            points[draggingIdx][1] = Math.max(0, Math.min(100, y));
            updatePointsUI();
        });

        window.addEventListener('mouseup', () => {
            if (draggingIdx !== null) {
                draggingIdx = null;
                updatePointsUI();
            }
        });

        document.getElementById('toggle-sidebar').addEventListener('click', () => {
            sidebarOpen = !sidebarOpen;
            sidebar.style.width = sidebarOpen ? '288px' : '0';
            sidebar.style.opacity = sidebarOpen ? '1' : '0';
            setTimeout(updatePointsUI, 305);
        });

        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.className = 'tab-btn px-4 py-1 text-[11px] font-bold rounded-md text-zinc-400 hover:text-white transition-colors');
                btn.className = 'tab-btn px-4 py-1 text-[11px] font-bold rounded-md bg-blue-600 text-white shadow-sm';
                activeTab = btn.dataset.tab;
                renderCode();
            };
        });

        document.getElementById('copy-btn').onclick = (e) => {
            const code = codeOutput.innerText;
            const btn = e.currentTarget;
            navigator.clipboard.writeText(code).then(() => {
                const label = btn.querySelector('span');
                const oldText = label.innerText;
                label.innerText = 'Copied!';
                btn.classList.add('bg-emerald-500', 'text-white');
                setTimeout(() => {
                    label.innerText = oldText;
                    btn.classList.remove('bg-emerald-500', 'text-white');
                }, 1500);
            });
        };

        // --- Init Presets ---
        function setupPresets() {
            Object.keys(presets).forEach(cat => {
                const container = document.getElementById(`presets-${cat}`);
                presets[cat].forEach(p => {
                    const btn = document.createElement('button');
                    btn.className = 'w-full flex items-center gap-3 p-2.5 rounded-xl border border-transparent hover:border-zinc-800 hover:bg-zinc-900/40 transition-all text-left group';
                    const clip = `polygon(${p.pts.map(pt => `${pt[0]}% ${pt[1]}%`).join(', ')})`;
                    btn.innerHTML = `
                        <div class="w-10 h-10 bg-zinc-900 border border-zinc-800 rounded-lg flex-shrink-0 flex items-center justify-center p-1.5 overflow-hidden group-hover:border-blue-500/50 transition-colors">
                            <div class="w-full h-full bg-blue-600/80" style="clip-path: ${clip}"></div>
                        </div>
                        <div class="flex flex-col min-w-0">
                            <span class="text-[11px] font-bold text-zinc-300 group-hover:text-white transition-colors">${p.name}</span>
                            <span class="text-[9px] text-zinc-600 font-bold uppercase tracking-tight">${p.pts.length} Nodes</span>
                        </div>
                    `;
                    btn.onclick = () => {
                        points = JSON.parse(JSON.stringify(p.pts));
                        updatePointsUI();
                    };
                    container.appendChild(btn);
                });
            });
        }

        // Initialize
        window.addEventListener('resize', updatePointsUI);
        setupPresets();
        updatePointsUI();

    </script>
</body>
</html>